# CPU architecture and core dumps

A core dump is a snaphot of the process memory (plus CPU registers) at the time of the crash. All the samples in this repository are generated using an Intel 64bit CPU, the Intel(R) Core(TM) i5-7400. This means that CPUs with different achirectures will not be able to load the core dumps correctly. This is the case of the Apple M1/2/3 which is ARM-based. 

Loading Intel core dumps on Apple silicone will result in something similar to the following:

```
...
Reading symbols from test2...
...
warning: Couldn't find general-purpose registers in core file.
warning: Unexpected size of section `.reg2' in core file.
Core was generated by `./test2'.
warning: Couldn't find general-purpose registers in core file.
warning: Unexpected size of section `.reg2' in core file.
#0  <unavailable> in ?? ()
(gdb) 

```

As you can see gdb has problems with loading the core dump correctly. [gdb-multiarch](https://packages.ubuntu.com/focal/gdb-multiarch) is a version of gdb that is able to support multiple architectures. You need to first install itP 

```
sudo apt install gdb-multiarch
``` 

and then use it as you do with normal gdb:

```
gdb-multiarch program core
```

This should allow you to load core dumps generated by a different architecture, **but this is known to not always work!** A work-in-progress is the experimentation with ```set architecture x86_64-linux-gnu``` after loading the core dump, similar to what is suggested here: https://www.generacodice.com/en/articolo/4856479/gdb-won-t-read-core-file-from-foreign-architecture.


